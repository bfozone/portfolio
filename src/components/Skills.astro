---
import { skills } from "../data/resume";

const categoryColors: Record<string, string> = {
  Risk: "var(--ctp-green)",
  Quantitative: "var(--ctp-teal)",
  Languages: "var(--ctp-mauve)",
  "Frameworks & Libraries": "var(--ctp-pink)",
  "Data Infrastructure": "var(--ctp-lavender)",
  Platforms: "var(--ctp-blue)",
  DevOps: "var(--ctp-peach)",
};
---

<section id="skills" class="py-20">
  <div class="max-w-5xl mx-auto px-4 sm:px-6">
    <div class="fade-in">
      <h2 class="font-mono text-sm text-[var(--ctp-green)] mb-12">
        &gt; cogitator.skills
      </h2>
    </div>

    <div class="flex flex-col gap-3 max-w-3xl">
      {
        Object.entries(skills).map(([category, text], index) => {
          const color = categoryColors[category] || "var(--ctp-mauve)";
          return (
            <div
              class="fade-in skill-accordion bg-[var(--ctp-mantle)] border border-[var(--ctp-surface1)] rounded-lg overflow-hidden hover:border-[var(--ctp-mauve)] transition-colors duration-200"
              style={`transition-delay: ${index * 100}ms`}
            >
              <button
                class="skill-toggle w-full flex items-center justify-between px-6 py-4 cursor-pointer"
                type="button"
              >
                <h4
                  class="font-mono text-sm font-semibold"
                  style={`color: ${color}`}
                >
                  {category}
                </h4>
                <svg
                  class="skill-chevron w-4 h-4 transition-transform duration-200"
                  style={`color: ${color}`}
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  viewBox="0 0 24 24"
                >
                  <path d="M6 9l6 6 6-6" />
                </svg>
              </button>
              <div class="skill-content">
                <div class="px-6 pb-4">
                  <p class="text-sm text-[var(--ctp-subtext0)] leading-relaxed">
                    {text}
                  </p>
                </div>
              </div>
            </div>
          );
        })
      }
    </div>
  </div>
</section>

<style>
  .skill-content {
    display: grid;
    grid-template-rows: 0fr;
    transition: grid-template-rows 0.2s ease;
  }

  .skill-content > div {
    overflow: hidden;
    min-height: 0;
  }

  .skill-accordion.open .skill-content {
    grid-template-rows: 1fr;
  }

  .skill-accordion.open .skill-chevron {
    transform: rotate(180deg);
  }
</style>

<script>
  document.querySelectorAll(".skill-toggle").forEach((btn) => {
    btn.addEventListener("click", () => {
      btn.closest(".skill-accordion")?.classList.toggle("open");
    });
  });
</script>
